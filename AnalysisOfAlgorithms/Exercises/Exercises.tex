\topglue 0.5in
\centerline {\tt Analysis of Algorithms}
\vskip 0.3in
\centerline {Chapter 1}
\vskip 0.2in

\noindent {\bf Problem 1.4} Evaluating for $N$ even,
$C_N = 2 C_{N/2} + 1$ and $C_{N+1} = C_{N/2 + 1} + C_{N/2} + 1$,
so $C_{N+1} - C_N = C_{N/2 + 1} - C_{N/2} + 1$.
For $N$ odd this is $C_{N+1} - C_N = C_{N/2 + 1/2} - C_{N/2 - 1/2} + 1$.
Note that these are actually the same for successive values of $N$ --
that is, $C_6 - C_5 = C_5 - C_4 = C_3 - C_2 + 1$.  So the first
step always reduces to $N$ even, and we only have to consider
that case.  Telescoping, we are dividing by 2 at every step, ending
up with $C_2 - C_1 = 2$, so $C_{N+1} - C_{N} = \lfloor {\rm lg} N
\rfloor + 2$.  Telescoping that in turn gives the desired result:
$$
 C_N = \sum_{1 \le k < N} \left(\lfloor {\rm lg} \rfloor + 2\right).
$$

\vskip 0.08in \noindent {\bf Problem 1.7} Substituting we get
$t_{2N} = 2 c N {\rm lg}\, 2 N + 2 d N = 2 c N {\lg} N 
+ 2 d N + 2 c N = 2 t_N + 2 c N$.  Next, note that
$2 t_N / {\rm lg} N = 2 c N + 2 d N / {\rm lg} N$, so this
is 
$$
 t_{2N} = 2 t_{N} \left(1 + {1 \over {\rm lg} N}\right) - {2 d N \over {\rm lg} N},
$$
which doesn't quite match the problem statement.  But the
error term is ${\rm O} N / {\rm lg} N$, so it's not a terrible approximation
unless $d$ is rather large and $N$ small.

\vskip 0.08in \noindent {\bf Problem 1.14}: Evaluate 
$A_N = 1 + 2 / N \sum_{1 \le j \le N} A_{j-1}$.
Multiply by $N$ to get $N A_N = N + 2 \sum_{1 \le j \le N} A_{j-1}$,
then write the same equation for $N-1$: ($\left(N - 1\right) 
A_{N-1} = N  - 1 + 2 \sum_{1 \le j \le N-1} A_{j-1}$) and subtract the two
to get $N A_N - \left(N - 1\right) A_{N-1} = 1 + 2 A_{N-1}$.  Now
divide by $N \left(N - 1\right)$ to get
$$
{A_N \over N  + 1} = {A_{N-1} \over N} + {1 \over N \left(N + 1\right)}.
$$
Now telescope to get
$$
 {A_N \over N - 1} = {A_1 \over 2} + \sum_{j = 1}^N {1 \over j \left(j + 1\right)}.
$$
If we write $1 / j \left(j + 1\right)$ as $1 / k - 1 / k+1$ then all the terms except
the first and last cancel in the sum, leaving $1 - 1 / N + 1 = N / N + 1$.
Thus,
$$
 A_N = \left(N + 1\right) A_1 / 2 + N .
$$

\vskip 0.08in \noindent {\bf Problem 1.15}: Say that the partition
element belongs in position $j$ (where $0 \le j < N$, so 0 based
numbering).  The chance of this happening is $1/N$, independent
of $j$.  There are $N - j - 1$ elements to the right, and $j$ to the left.
The ones on the right have a $j / N-1$ chance of needing to be
swapped, so the expected number of exchanges is 
$$
 E_j = {j \over N - 1} \left(N - j - 1\right) = j - {j^2 \over N - 1}
$$
and so the average number of swaps overall is
$$
  \alpha = {1 \over N} \sum_{0 \le j < N} E_j =
   {1 \over N} \sum_{0 \le j < N} j - {1 \over N \left(N - 1\right)} \sum_{0 \le j < N} j^2.
$$
Now we take advantage of $\sum j = N \left(N + 1\right) / 2$
and $\sum j^2 = N \left(N + 1\right) \left(2 N + 1\right)$, but
note that those are for sums over $1 \le j \le N$, so we have to
replace $N$ by $N-1$.  In any case that gives
$$
 \alpha = {N - 1 \over 2} - {2 N - 1 \over 6} = {3 N  - 3 - 2 N + 1 \over 6} 
  = {N - 2 \over 6}
$$
as advertised.

\vskip 0.08in \noindent {\bf Problem 1.17}\hfil\break
Symmetrizing the sum, we have
$$ 
  C_N = \cases{ N + 1 + \sum_{j=1}^N C_{j-1} & if $N > M$;\cr
                          {1 \over 4} N \left(N - 1\right) & if $N \le M$. \cr}
$$
The usual steps follow for $N > M$ to give
$$
  {C_N \over N + 1} = {C_{N - 1} \over N} + {2 \over N + 1}
$$
but this time when we telescope we only get down to $C_M$,
so
$$
  {C_N \over N + 1} = {C_M \over M + 1} + 2 \sum_{k = M+2}^{N+1} {1 \over k} =
    {1 \over 4} {M \left(M - 1\right) \over M + 1} + 2 \left(H_{N+1} - H_{M+2}\right)
$$
so
$$
  C_N = 2 \left(N + 1\right)\left[ {1 \over 8} {M \left(M - 1\right) \over M + 1}
   + H_{N+1} - H_{M+2}\right] .
$$

\vskip 0.08in \noindent {\bf Problem 1.18}\hfil\break
Ignoring the approximation business, just evaluating this
directly gives a minimum at $M = 6$.

\vskip 0.3in
\centerline {Chapter 2}
\vskip 0.2in

\noindent {\bf Problem 2.6}: Solve the recurrence $a_n = a_{n-1} + a_{n-2}$
with $a_0 = p$ and $a_1 = q.$\hfil\break
This is the Fibonnaci recursion but with different initial coefficients.
The solution is therefore $a_0 u_n + a_1 v_n = p u_n + q v_n$
where $u_n = u_{n-1} + u_{n-2}$ with $u_0 = 1$ and $u_1 = 0$,
and $v_n = v_{n-1} + v_{n-2}$ with $u_0 = 0$ and $u_1 = 1$.
The second is just the usual, so $v_n = F_n$.  $u_n$ written out is
$1, 0, 1, 1, 2, \ldots = F_{n-1}$ except for $u_0$.  Therefore,
$a_n = p F_{n-1} + q F_n$ for $n > 1$.

\vskip 0.08in \noindent {\bf Problem 2.7} Guess that the solution
to the inhomogeneous part is a constant $c_0$.  Combining with
the previous solution we have $a_n = p F_{n-1} + q F_n + c_0$,
and substituting into the defining equation:
$$
 p F_{n-1} + q F_n + c_0 = p \left(F_{n-2} + F_{n - 3}\right)
  + q \left(F_{n-1} + F_{n-2}\right) + \left(p + q\right) c_0 + r.
$$
Since $F_{n-1} + F_{n-2} = F_n$, this becomes
$c_0 = \left(p + q\right) c_0 + r$, so 
$a_n = p F_{n-1} + q F_n + r / \left(1 - p - q\right)$ for $n>1$.

\vskip 0.08in \noindent {\bf Problem 2.9}: 
$$
a_n = {n \over n + 2} a_{n - 1} = {n \over n + 2} {n - 1 \over n + 1}
{n - 2 \over n} \ldots {3 \over 5} {2 \over 4} {1 \over 3} = 
{2 \over \left(n + 2\right) \left(n + 1\right)}
$$

\vskip 0.08in \noindent {\bf Problem 2.10} $a_n = a_{n-1} + \left(-1\right)^n n$
with $a_0 = 1$.\hfil\break
Immediately, we see that
$$
 a_n = \sum_{0 \le k \le n} \left(-1\right)^k + 1 = 
 \sum_{0 \le k \le n, k \, {\rm even}} k \, - \sum_{0 \le k \le n, k \, {\rm odd}} k + 1 .
$$
Now
$$
 \sum_{0 \le k \le n, \, k {\rm even}} = 
 \cases{
   {n \over 2} \left( {n \over 2} - 1 \right), & if $n$ is even;\cr
   \left({n - 1 \over 2}\right) \left({n + 1 \over 2}\right) & if $n$ is odd .\cr}
$$
We can then write even - odd as 2 times odd minus all, so
$$
a_n = \cases{
 n \left(n / 2 + 1\right) - n \left(n + 1\right) / 2 + 1, & if $n$ is even\cr
 \left(n + 1\right) \left({n - 1 \over 2}\right) - n \left(n + 1\right) / 2 + 1 & if $n$ is odd.\cr
}
$$

\vskip 0.08in \noindent {\bf Problem 2.11}: Solve $n a_n = \left(n - 2\right) a_{n-1} + 2$
with $a_1 = 1$\hfil\break
Multiply both sides by $n-1$: 
$$
n \left(n - 1\right) a_n = 
\left(n - 1 \right) \left(n - 2\right) a_{n-1} + 2 \left(n - 1\right) =
\left(n - 2 \right) \left(n - 3\right) a_{n-2} + 2 \left(n - 1\right) + 2 \left(n - 2\right).
$$
Continuing to telescope, this becomes $2 a_2 + 2 \left(\left(n - 1\right) + \ldots + 2\right)
= 2 a_2 + 2 \left(n - 1 + n - 2 + \ldots + 1\right) - 2$, which simplifies to
$2 a_2 + n \left(n - 1\right) - 2$, but $2 a_2 = 0 a_1 + 2 = 2$, so finally
$n \left(n - 1\right) a_n = n \left(n - 1\right)$, and $a_n = 1$.

\vskip 0.08in \noindent {\bf Problem 2.12}: $a_n = 2 a_{n-1} + 1$.\hfil\break
Divide both sides by $2^n$ and telescope:
$$
{a_n \over 2^n} = {a_{n-1} \over 2^{n-1}} + {1 \over 2^n} =
{a_{n-2} \over 2^{n-2}} + {1 \over 2^n} + {1 \over 2^{n-1}} = {1 \over 2}
+ {1 \over 4} + \ldots {1 \over 2^n}.
$$
This is a geometric series $\sum \left(1/2\right)^k = \left(1 - \left(1/2\right)^{n+1}\right) /
\left(1 - 1/2\right) = 2 \left(1 - \left(1 / 2\right)^{n+1}\right)$, and so
$a_n = 2^{n+1} - 1$.  This is the recurrence for the Towers of Hanoi.

\vskip 0.08in \noindent {\bf Problem 2.13}: Solve $a_n = n / \left(n+1\right) a_{n-1} + 1$ with 
$a_0 = 1$.\hfil\break
Divide by 
$$
 x_n x_{n-1} \ldots x_1 = {n \over n + 1} {n - 1 \over n} \ldots {1 \over 2} = {1 \over n + 1}
$$
to get
$$
 \left(n + 1\right) a_n = n a_{n-1} + \left(n + 1\right)
  = \left(n - 1\right) a_{n-2} + \left(n + 1\right) + n = a_0 + \left(n+1\right) + n +
  \left(n - 1\right) + \ldots + 2,
$$
which, since $a_0 = 1$, is just the sum of integers from 1 to $n+1$, or
$\left(n + 1\right)\left(n + 2\right) / 2$.  Dividing across,
$$ 
 a_n = {n + 2 \over 2}.
$$

\vskip 0.08in \noindent {\bf Problem 2.15}: $n a_n = \left(n + 1\right) a_{n-1} + 2 n$.
\hfil\break Start by dividing by $n$ to get $a_n = \left(n + 1\right) / n a_{n-1} + 2$.
Now divide by $n+1$ and telescope:
$$
 {a_n \over n + 1} = {a_{n-1} \over n} + {2 \over n + 1} =
 {a_{n-2} \over n - 1} + {2 \over n + 1} + {2 \over n} =
 {a_{n-3} \over n - 2} + {2 \over n + 1} + {2 \over n} + {2 \over n - 1} =
 a_0 + 2 \sum_{1 \le k \le n + 1} {1 \over k}.
$$
Since $a_0 = 0$ (boundary condition), this is just $a_n = 2 \left(n + 1\right) H_{n + 1}$.

\vskip 0.08in \noindent {\bf Problem 2.17}: Fringe analysis\hfil\break
The simplified expression is
$$
 A_N = 2 + A_{N-1} {N - 6 \over N}, N > 0, A_0 = 1
$$
There's something rather odd here -- this goes negative.  For example,
$A_2 = -3$.   Okay, this is because of a typo in the book -- we should have
$A_0 = 1$, not $A_0 = 0$.  The first few terms are:
$A_0 = 1, A_1 = -3, A_2 =  8, A_4=-6, A_5=5, A_5 = 1, A_6 = 2$.

So, it makes sense to work with the shifted series $A^{\prime}_n = A_{n-6}$
with
$$
 A^{\prime} = 2 + A^{\prime}_{N-1} {N \over N + 6}, A_1 = 2 .
$$
and so odd things will also happen around $N = 6$.  
So now we divide both sides by $x_n x_{n-1} \ldots x_1$ where
$x_n = n / \left(n + 6\right)$ as usual.  Writing this out, this is 
the same as multiplying by $n + 6 \choose n$.  We can drop the $6!$
and thus it is the same as multiplying by $\left(n + 1\right)\ldots\left(n+6\right)$.
When we substitute, this becomes
$$
 \left(n+1\right)\ldots\left(n+6\right) a^{\prime}_n = 2 \left(n+1\right)\ldots
 \left(n+6\right) 2 + a^{\prime}_{n-1} n \left(n+1\right)\ldots\left(n+5\right).
$$
Iterating this, and taking advantage of $a^{\prime}_0 = 2$ gives
$$
\left(n+1\right)\ldots\left(n+6\right) a^{\prime}_n = 2 \sum_{k=1}^{n+1}
k \left(k + 1\right)\ldots\left(k+5\right).
$$

So, how do we evaluate a sum like this?  In general say we have
$$
 \sum_{k=1}^{n+1} \prod_{j=0}^{\alpha} \left(k + j\right)?
$$
(In our example, $\alpha = 5$).  Well, if we multiply both sides by 
$\left(\alpha + 1\right) !$, we have
$$
 \sum_{k=1}^{n+1} \prod_{j=0}^{\alpha} \left(k + j\right) =
 \left(\alpha + 1\right)! \sum_{k=1}^{n+1} {\left(k + \alpha\right)!
   \over \left(k - 1\right)! \left(\alpha + 1\right)!} =
    \left(\alpha + 1\right)! \sum_{k=1}^{n+1} {k + \alpha \choose k - 1}
     = \left(\alpha + 1\right)! \sum_{k=0}^{n} {k + \alpha + 1 \choose k}
$$
Now we take advantage of the relation
$$
 \sum_{k=0}^n {r + k \choose k} = {r + n + 1 \choose n}
$$
(for example, Knuth vol 1 p. 56, eq.~1.2.6.(10)).  So, $r=\alpha + 1$
and we have
$$
  \sum_{k=1}^{n+1} \prod_{j=0}^{\alpha} \left(k + j\right) =
  \left(\alpha + 1\right)! {\alpha + n + 2 \choose n} =
  \left(\alpha + 1\right)! {\left(\alpha + n + 2\right) \over n! \left(\alpha + 2\right)!} =
  { \left(\alpha + n + 2\right)! \over n! \left(\alpha + 2\right)}
  = {1 \over \alpha + 2} \prod_{j=1}^{\alpha + 2} \left(n + j\right).
$$
As an example, $\sum_{k=1}^{n+1} n \left(n + 1\right) \left(n + 2\right)
 = {1 \over 4} \left(n + 1\right)\left(n + 2\right) \left(n + 3\right) \left(n + 4\right).$
 In our case we are left with
$$
\left(n+1\right)\ldots\left(n+6\right) a^{\prime}_n = {2 \over 7}
\left(n + 1\right) \ldots \left(n + 7\right)
$$
so
$$ 
 a^{\prime}_n = {2 \over 7} \left(n + 7\right),
$$
or, in terms of the original series,
$$
 A_n  = 2 + {2 \over 7} \left(n - 6\right)
$$
for $n \ge 6$ (and values below that being rather odd).

\vskip 0.08in \noindent {\bf Problem 2.25}: Give a recurrence
that has the solution $a_n = 4^n - 3^n + 2^n$.\hfil\break
We're looking for an equation of the form $\left(1 - 4 x\right)
\left(1 - 3 x\right) \left(1 - 2 x\right)$ plus the appropriate boundary
conditions.  Multiplied out, this is $-24 x^2 + 26 x^2 - 9 x + 1$,
which corresponds to $a_n = 9 a_{n-1} - 26 a_{n-2} - 24 a_{n-3}$
with the boundary conditions simply from substitution: $a_0 = 1$,
$a_1 = 3$, $a_2 = 11$.

\vskip 0.08in \noindent {\bf Problem 2.27} Give initial conditions $a_0, a_1$
for which the solution to $a_n = 5 a_{n-1} - 6 a_{n-2}$ is $2^n$.\hfil\break
The characteristic polynomial is $1 - 5 x + 6 x^2 = \left(1 - 3 x\right)
\left(1 - 2 x \right)$, so the solution is $a_n = c_0 3^n + c_1 2^n$.
So we need $c_0 = 0$, $c_1 = 1$.  We have $a_0 = c_0 + c_1$,
$a_1 = 3 c_0 + 2 c_1$, so $a_0 = 1$, $a_1 = 2$ works.
There is no set of initial conditions that gives $a_n = 2^n - 1$.

\vskip 0.08in \noindent {\bf Problem 2.29} Solve $a_n = 2 a_{n-1}  + 4 a_{n-2}$
for $n > 1$ with $a_1=2$ and $a_0 = 1$.\hfil\break
We have $n \ge 2$, so the characteristic polynomial is $z^2 - 2 z + 4 = 0$,
or $\left(z -2\right)^2 = 0$.  Thus, we have degenerate root, and the solutions
are of the form $a_n = c_0 2^n + c_1 n 2^n$.  The initial conditions give us
$1 = a_0 = c_0$, and $2 = a_1 = 2 c_0 + 2 c_1$, or $c_0 + c_1 = 1$.
Together, we have $c_0 = 1$, $c_2 = 0$, and $a_n = 2^n$.

\vskip 0.08in \noindent {\bf Problem 2.30} Solve $a_n = 2 a_{n-1} + 4 a_{n-2}$
for $n > 1$ with $a_0 = 0$ and $a_1 = 1$.\hfil\break
Here the characteristic polynomial is $z^2 - 2 z + 1 = \left(z - 1\right)^2 = 0$.
So $a_n = c_0 + c_1 n$.  $a_0 = 0$ implies that $c_0 = 0$, so
$a_n = n$.  

Changing the initial conditions to $a_0 = a_1 = 1$ gives us
$c_0 = 1$, $c_1 = 0$, so $a_n = 1$.

\vskip 0.08in \noindent {\bf Problem 3.20}: Evaluate the
recurrence $a_n = 3 a_{n-1} - 3 a_{n-2} + a_{n-3}$ for $n > 2$.\hfil\break
The characteristic polymonial is $z^3 - 3 z^2 + 3 z - 1 = \left(z - 1\right)^3$.
Thus, it has root 1 with multiplicity 3, and the solution is of the form
$a_n = c_0 1^n + c_1 n 1^n + c_2 n^2 1^n = c_0 + c_1 n + c_2 n^2$.
For $a_0 = a_1 = 0$, $a_2 = 1$, we find $c_0 = 0$, $c_1 + c_2 = 0$,
and $2 c_1 + 4 c_2 = 1$, which, when solved, give $a_n = -n / 2 + n^2/2$.
For $a_0 = 0$, $a_1 = a_2 = 1$, we find $c_0 = 0$, $c_2 = 1 - c_1$,
and $2 c_1 + 4 c_2 = 1$, giving $a_n = 3/2 n - 1/2 n^2$.

\vskip 0.08in \noindent {\bf Problem 3.28} Find
$$
 \left[z^n\right] {1 \over \sqrt{1 - z}} \log {1 \over 1 - z}.
$$
Following the hint, we
have
$$
 \left(1 - z\right)^{-\alpha} = \sum_k {\alpha + k + 1 \choose k} z^k
$$
(the `negative' binomial theorem), and
$$
 {\partial \over \partial \alpha} \left(1 - z \right)^{-\alpha}
  = \left(1 - z\right)^{-\alpha} \log \left({1 \over 1 - z}\right).
$$
Thus, we can take the derivative and then substitute $\alpha = 1/2$.
However, the derivative is a bit of a mess.  Note that
$$
  {\alpha + k - 1 \choose k} = {1 \over k!} \prod_{i=0}^{k-1} \left(\alpha + i\right)
$$
if we take the derivative we simply remove each component in term.  Thus,
$$
 {\partial \over \partial \alpha} {\alpha + k - 1 \choose k} =
  {\alpha + k - 1 \choose k} \sum_{i=0}^{k-1} {1 \over \alpha + i}.
$$
Thus, the coefficient of the $n^{th}$ term is
$$
 {n - 1/2 \choose n} \sum_{i=0}^{n-1} {1 \over 1/2 + i}.
$$

Can we simplify this further?  Take $\alpha + k - 1 \choose k$ for $\alpha = 1/2$.
This is by the formula given earlier 
$$
 {1 \over k!} \left({1 \over 2} {3 \over 2} \ldots {2k - 1 \over 2}\right) =
  {\left(2k\right)!! \over 2^k}.
$$
But $\left(2k - 1\right)!! 2^n n! = \left(2 n\right)!$ if written out,
so
$$
 {1/2 + n - 1 \choose 1/2} = {\left(2 n\right)! \over 2^n 2^n n!} = {1 \over 4^n} {2n \choose n}.
$$
Now, the other term:
$$
 \sum_{i=0}^{n-1} {1 \over 1/2 + i} = \sum_{i=0}^{n-1} {2 \over 2 i + 1}
  = \left(2 + {2 \over 3} + {2 \over 5} + \ldots + {2 \over 2 n - 1}\right)
  = 2 \left(H_{2n} - {1 \over 2} H_n\right)
$$
and so
$$
 \left[z^n\right] {1 \over \sqrt{1 - z}} \log {1 \over 1 - z} =
  {1 \over 2^{2n-1}} {2n \choose n} \left(H_{2n} - {1 \over 2} H_n\right).
$$

\vskip 0.08in \noindent {\bf Problem 5.1} How many bitstrings of
length $N$ have no 000?\hfil\break
Such strings are either $\epsilon$, a single 0, two 0s, or 1 or 01 or 001 followed
by a string with no 3 consecutive zero bits.  Figuring out which ones
don't have to be included is a bit tricky; for example, 010 is just 01 followed
by a string with no two consecutive 1 bits, but 00 is not just 0 followed
by any such string.  So
$$
 {\cal G} = \epsilon + {\cal Z}_0 + {\cal Z}_0 \times {\cal Z}_0
   + \left({\cal Z}_1 + {\cal Z}_0 \times {\cal Z}_1 
   + {\cal Z}_0 \times {\cal Z}_0 \times {\cal Z}_1\right) \times {\cal G}.
$$
This is then $G\left(z\right) = 1 + z + z^2 + \left(z + z^2 + z^3\right) G\left(z\right)$,
or $G\left(z\right) = \left(1 + z + z^2\right) / \left(1 - z - z^2 - z^3\right)$.  I can't
find any particular way to simplify this -- the first few terms of the expansion
are $1 + 2z + 4z^2 = 7z^3 + 13z^4 + 24z^5 + \ldots$.

<<<<<<< HEAD
\vskip 0.08in \noindent {\bf Problem 5.2} How many bitstrings of
=======
\vskip 0.08in \noindent {\bf Problem 5.1} How many bitstrings of
>>>>>>> 54f0c39bbd1f0670e0baa2dfd2cbbb018269c283
length $N$ have no 01?\hfil\break
Such strings are either $\epsilon$, a 1 followed by a sequence with no 01,
or a sequence of 0s.  However, $\epsilon$ is counted as a sequence of 0s. That is:
$$
<<<<<<< HEAD
 {\cal G} = {\cal Z}_1 \times {\cal G} + {\cal SEQ}\left({\cal Z}_0\right)
=======
 {\cal G} = {\cal Z}_1 \times {\cal G} + {\cal SEQ}\left({\cal Z_0}\right)
>>>>>>> 54f0c39bbd1f0670e0baa2dfd2cbbb018269c283
$$
or $G\left(z\right) = z G\left(z\right) + 1 /\left( 1 - z \right) $, so that
$G\left(z\right) = 1 / \left(1 - z\right)^2$ and $\left[z^n\right] G\left(z\right) =
{n + 1 \choose n} = n + 1$.  For $n=3$, for example, these are
$000, 100, 110, 111$.  Alternatively, we could just say that
${\cal G} = {\cal SEQ}\left({\cal Z}_1\right) \times {\cal SEQ}\left({\cal Z}_0\right)$,
a sequence of 1s followed by a sequence of 0s, which gives the same result.

\vskip 0.08in \noindent {\bf Problem 5.3} Get an explicit expression for the 
generating function for the size of trees counting both internal and external nodes.
This is pretty straightforward: 
$$
 {\cal T} = {\cal Z}_{\circ} + {\cal Z}_{\bullet} \times {\cal T} \times {\cal T}.
$$
For this problem we count external ($\circ$) and internal ($\bullet$) nodes,
so this becomes $T = z + z T^2$, or
$$
 T\left(z\right) = {1 \pm \sqrt{1 - 4 z^2} \over 2 z}.
$$
where the boundary condition $T\left(0\right) = 0$ suggests we take the negative branch.

\vskip 0.08in \noindent {\bf Problem 5.7} Sets of cycles of odd length:
immediately we are lead to 
$$
{\cal D} = {\rm SET} \left(
{\rm CYC}_1\left({\cal Z}\right) + {\rm CYC}_3 \left({\cal Z}\right) +
 {\rm CYC}_5 \left({\cal Z}\right) + \ldots \right)
 $$
 so that we have the EGF
 $$
 P^{\star}_{\rm odd} = \exp \left( \ln {1 \over 1 - z } - z^2/2 - z^4/4 - \ldots\right)
  = { e^{-z^2/2 - z^4/4 - \ldots} \over 1 - z }
$$

\vskip 0.08in \noindent {\bf Problem 5.8} Sequences of cycles are (immediately
$$
  S = {1 \over {1 - \ln {1 \over 1 - z}}} = {1 \over 1 + \ln \left(1 - z\right)}.
$$

\vskip 0.08in \noindent {\bf Problem 5.9} Cycles of sequences are
$$
 C = \ln {1 \over {1 - {1 \over 1 - z}}} = \ln {z - 1 \over z}
$$

<<<<<<< HEAD
\vskip 0.08in \noindent {\bf Problem 5.12} Average number of 1 bits in a bitstring.\hfil\break
We have ${\cal B} = {\cal SEQ}\left({\cal Z}_0 + {\cal Z}_1\right)$.  ${\cal Z}_0$
is $z$ and ${\cal Z}_1$ is $zu$ here (since only ones have, uh, ones).
Thus 
$$
 B = 1 / \left(1 - \left(1 + u\right) z\right),
$$
$$
B_u = z / \left(1 - \left(1 + u\right) z\right)^2 ,
$$ 
and
$$
 B_u\left(z, 1\right) = {z \over \left(1 - 2 z\right)^2} .
$$
To evaluate this, define $z^{\prime} = 2 z$ so that $\left[z^{\prime\,n}\right] B_u\left(z^{prime},1\right) =
\left[z^{\prime\, n}\right] 1/2 z^{\prime} / \left(1 - z^{\prime}\right)^2 = 1 / 2 {n \choose 1} = n / 2$.
Clearly $\left[z^n\right] B_u = 2^n \left[z^{\prime\,n}\right] B_u = 2^{n-1} n$.  The
average number of 1s is $\left[z^n\right] B_u\left(z, 1\right) / \left[z^n\right] B\left(z\right) =
2^{n-1} n / n = n / 2$, as expected.

=======
>>>>>>> 54f0c39bbd1f0670e0baa2dfd2cbbb018269c283
\vskip 0.08in \noindent {\bf Problem 5.15} I don't find the exposition in the
text very useful here, so let's use a different one.  Define the recurrent for
non-empty binary trees by
$$
 {\cal N} = {\cal Z}_{\bullet} \times {\cal E} \times {\cal E}
 + {\cal Z}_{\bullet} \times {\cal E} \times {\cal N}
 + {\cal Z}_{\bullet} \times {\cal N} \times {\cal E}
 + {\cal Z}_{\bullet} \times {\cal N} \times {\cal N}
$$
or $N = z + 2 z N + z N^2$ (simply concentrating on the non-bivariate
generating function for now).  Next, note that ${\cal T} = {\cal E} + {\cal N}$,
so we can substitute $N = T - 1$ into the above to arrive at the standard
generating function $T = 1 + z T^2$.  To do the example given in the book
(leaves), we identify only the first one as $z u$ to derive
$N = z u + 2 z N + z N^2$, so $T = 1 + zu + 2 z T - 2z + z T^2 - 2 z T + z =
1 - z + z u + z T^2$, which is the same as the formula in the book.

So, proceeding to the actual problem, now only the last element gets a $z u$
(both children internal), giving $N = z + 2 z N + z u N^2$, or
$T = 1 - z \left(1 - u\right) + 2 z \left(1 - u\right) T + z u T^2$.
Recall from Theorem 3.8 we want to evaluate $\partial T \left(z, u\right) / \partial u |_{u=1} /
T\left(z, 1\right)$.  Substituting and evaluating gives
$$
 {\partial T \left(z, u\right) \over \partial u} {\Big \vert}_{u=1} =
  {z - 2 z T + z T^2 \over 1 - 2 z T} = {z \left(1 - T\left(z, 1\right)\right)^2 
  \over 1 - 2 z T\left(z,1\right)}.
$$
and
$$
 T\left(z, 1\right) = 1 + z T^2\left(z, 1\right).
$$
We can solve the latter to find $2 z T = 1 - \sqrt{1 - 4 z}$
so that $1 - 2 z T\left(z, 1\right) = \sqrt{1 - 4 z}$ and expand the top
to get
$$
 { \partial T\left(z, u\right) / \partial u {\vert}_{u=1} \over T\left(z, 1\right) }
  = {z / \sqrt{1 - 4 z} \over T\left(z, 1\right)} - {2 z \over \sqrt{1 - 4 z}}
   + {z T \over \sqrt{1 - 4 z}}.
$$
Now we want to extract the coefficients.
The first term is just the one from the leaves calculation in the book:
$$
 {{\left[ z^n \right] z \over \sqrt{1 - 4z}} \over {1 \over n + 1} {2n \choose n}} =
 {\left(n+1\right) n \over 2 \left(2 n - 1\right)}.
$$
The second is just twice the top part of the calculation:
$$
 \left[ z^n \right] {2 z \over \sqrt{1 - 4 z}} = 2 { 2 n - 2 \choose n - 1 }.
$$
The final term can be expanded using $z T = 1/2 \left(1 - \sqrt{1 - 4 z}\right)$
to be
$$
 \left[ z^n \right] \left({1 \over 2} {1 \over \sqrt{1 - 4 z} - {1 \over 2}} \right) = {1 \over 2} 4^n
$$
(except for $n=0$) and so altogether the coefficient of $z^n$ is
$$
  {\left(n+1\right) n \over 2 \left(2 n - 1\right)} - 2 {2 n - 2 \choose n - 1} + 2^{2n - 1}
$$
\end